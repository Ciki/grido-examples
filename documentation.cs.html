<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Grido : DataGrid for Nette Framework" />
    <link rel="shortcut icon" href="favicon.ico">

    <link rel="stylesheet" href="css/style.css?1">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/gh-fork-ribbon.css?1">
    <link rel="stylesheet" href="css/highlight.github.edit.css">

    <!--[if IE]>
    <link rel="stylesheet" href="css/gh-fork-ribbon.ie.css">
    <![endif]-->
    <title>Grido</title>
</head>

<body>
    <div class="github-fork-ribbon-wrapper left">
        <div class="github-fork-ribbon">
            <a class="no-ajax" href="https://github.com/o5/grido">Fork me on GitHub</a>
        </div>
    </div>

    <div class="navbar navbar-inverse">
        <div class="navbar-inner">
            <ul class="nav">
                <li><a href="index.html">Home</a></li>
                <li class="active"><a href="documentation.cs.html">Documentation</a></li>
                <li><a target="_blank" href="http://grido.bugyik.cz/example/">Live demo</a></li>
                <li><a target="_blank" href="api/">API</a></li>
            </ul>
        </div>
    </div>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
    <header class="inner">
        <h1 id="project_title">Grido</h1>
        <h2 id="project_tagline">DataGrid for Nette Framework!</h2>

        <section id="downloads">
            <a class="zip_download_link" href="https://github.com/o5/grido/zipball/master">Download this project as a .zip file</a>
            <a class="tar_download_link" href="https://github.com/o5/grido/tarball/master">Download this project as a tar.gz file</a>
        </section>
    </header>
    </div>

    <div id="main_content_wrap" class="outer">
    <section id="main_content" class="inner documentation">

    <p class="perex">Grido (dále jen grid) je komponenta usnadňující
        <strong>výpis dat</strong>, jejich <strong>formátování</strong>,
        <strong>řazení</strong>, <strong>stránkování</strong>,
        <strong>filtrování</strong>, <strong>hromadné akce</strong> a <strong>export
            dat</strong>. Při návrhu byl kladen důraz na <strong>jednoduché použití a
            přizpůsobení</strong>.
    </p>

    <p class="caution">Samotný grid má závislost pouze na Nette, ale
        odkazované demo obsahuje klientský skript
        <a href="https://raw.github.com/o5/grido-sandbox/master/www/js/jquery.grido.js">jquery.grido.js</a>,
        který je spravován mimo hlavní repozitář. Veškeré jeho závislosti jsou uvedené v tomto souboru.
        Demo také využívá části frameworku
        <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.
    </p>

    <h3 id="instalace">Instalace</h3>

    <p>Komponentu si stáhněte a rozbalte do projektu, nebo nainstalujte pomocí <a href="http://doc.nette.org/cs/composer">Composeru</a>.</p>

<pre><code>{
    "require":
    {
        "php" : ">=5.3.2",
        "nette/nette": "2.0.*",
        "o5/grido": "dev-master"
    }
}</code></pre>

    <h3 id="pouziti">Použití</h3>

    <p>Grid vytvoříme továrničkou na komponenty, nastavíme model…</p>

<pre><code>protected function createComponentGrid($name)
{
    $grid = new Grido\Grid($this, $name);
    $grid->setModel($this->context->database->table('user'));
}</code></pre>

    <h3 id="settery-gridu">Settery gridu</h3>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>

            <th style="width: 270px">Příklad parametru / Výchozí</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>setModel</td>

            <td>model implementující rozhraní IDataSource nebo datasource objekt
                <a href="http://api.dibiphp.com/2.0/DibiFluent.html">DibiFluent</a>, <br>
                <a href="http://api.nette.org/2.0/Nette.Database.Table.Selection.html">Nette\Da­tabase\Table\Se­lection</a></td>

            <td> </td>
        </tr>

        <tr>
            <td>setDefaultFilter</td>

            <td>výchozí filtrování</td>

            <td> </td>
        </tr>

        <tr>
            <td>setDefaultSort</td>

            <td>výchozí řazení</td>

            <td>př.: array('column_name' ⇒ 'asc')</td>
        </tr>

        <tr>
            <td>setDefaultPerPage</td>

            <td>počet vykreslených položek na stranu</td>

            <td>20</td>
        </tr>

        <tr>
            <td>setPerPageList</td>

            <td>položky selectu "počet řádků na stranu"</td>

            <td>10, 20, 30, 50, 100</td>
        </tr>

        <tr>
            <td>setTranslator</td>

            <td>vlastní translátor</td>

            <td>FileTranslator</td>
        </tr>

        <tr>
            <td>setFilterRenderType</td>

            <td>nastaví vnitřní (Filter::RENDER_IN­NER) nebo vnější
                (Filter::RENDER_O­UTER) vykreslení filtrů</td>

            <td>vniřní, ale pokud grid obsahuje filtr, který nemá svůj sloupec,
                použije se vnejší vykreslení (stejně tak, když filtr nemá definovanou akci)</td>
        </tr>

        <tr>
            <td>setPaginator</td>

            <td>vlastní stránkovač</td>

            <td> </td>
        </tr>

        <tr>
            <td>setPrimaryKey</td>

            <td>primární klíč, který identifikuje řádek</td>

            <td>"id"</td>
        </tr>

        <tr>
            <td>setTemplateFile</td>

            <td>název šablony</td>

            <td>Grid.latte</td>
        </tr>

        <tr>
            <td>setRememberState</td>

            <td>ukládání stavu gridu do session</td>

            <td>FALSE</td>
        </tr>

        <tr>
            <td>setRowCallback</td>

            <td>callback volaný při vykreslení řádku tabulky. Callback vrací tr Html
                element</td>

            <td>function($row, Html $tr)<br>{return $tr}</td>
        </tr>
        </tbody>
    </table>

    <h3 id="gettery-gridu">Gettery gridu</h3>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>getCount</td>

            <td>vrátí celkový počet výsledků</td>
        </tr>

        <tr>
            <td>getColumn</td>

            <td>vrátí sloupec</td>
        </tr>

        <tr>
            <td>getFilter</td>

            <td>vrátí filtr</td>
        </tr>

        <tr>
            <td>getAction</td>

            <td>vrátí akci</td>
        </tr>

        <tr>
            <td>getOperations</td>

            <td>vrátí operace</td>
        </tr>

        <tr>
            <td>getFilterValue</td>

            <td>aktuální hodnota filtru</td>
        </tr>

        <tr>
            <td>getTranslator</td>

            <td>vrátí translátor (výchozí FileTranslator, př.:
                $grid->translator->setLang('cs');)</td>
        </tr>

        <tr>
            <td>getRememberSession</td>

            <td>vhodné např. pro nastavení expirace session</td>
        </tr>

        <tr>
            <td>getModel</td>

            <td>vhodné např. pro nastavení vlastní metody modelu</td>
        </tr>
        </tbody>
    </table>

    <h3 id="vlastni-metody-modelu">Vlastní metody modelu</h3>
    <p>Pokud potřebujeme změnit některou z modelových metod, lze místo dědění využít callback.</p>
    <pre><code>//reimplementace metody getCount()
$grid->model->callback['getCount'] = function($model) {
    $fluent = clone $model->fluent;
    return $fluent->removeClause('SELECT')->select('COUNT(*)')->fetchSingle();
};

//je samozřejmě možné "přetěžovat" všechny metody modelu,
//přičemž argumenty volané z gridu jsou předány jako pole v druhém parametru
$grid->model->callback['limit'] = function($model, $args) {
    $offset = $args[0];
    $limit = $args[1];
    //...
};</code></pre>

    <h3 id="udalosti-gridu">Události gridu</h3>

    <table>
        <thead>
        <tr>
            <th>Událost</th>
            <th>Popis</th>
            <th style="width: 180px">Příklad</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>onRender</td>
            <td>událost volající se při vykreslování gridu</td>
            <td>function (Grid $grid)</td>
        </tr>

        <tr>
            <td>onFetchData</td>
            <td>událost umožnující modifikovat data těsně před předání šabloně</td>
            <td>function (Grid $grid)<br>{return $grid->data}</td>
        </tr>
        </tbody>
    </table>

    <hr>

    <h3 id="sloupce">Sloupce</h3>

    <pre><code>$grid->addColumn('email', 'E-mail', Column::TYPE_MAIL);</code></pre>

    <p>První parametr reprezentuje název sloupce v datasource, následuje popisek
        a typ vykreslení. Typ je název třídy, který se má použít (lze uvést
        vlastní typ sloupce).</p>

    <h4 id="sloupce-typy">Typy</h4>

    <table>
        <thead>
        <tr>
            <th>Typ</th>

            <th>Metoda</th>

            <th>Popis</th>

            <th>Výchozí</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>TYPE_TEXT</td>

            <td>addColumnText</td>

            <td>výchozí typ, surový text</td>

            <td> </td>
        </tr>

        <tr>
            <td>TYPE_MAIL</td>

            <td>addColumnMail</td>

            <td>naformátuje výstup na klikací mail</td>

            <td> </td>
        </tr>

        <tr>
            <td>TYPE_HREF</td>

            <td>addColumnHref</td>

            <td>naformátuje výstup na klikací odkaz</td>

            <td> </td>
        </tr>

        <tr>
            <td>TYPE_DATE</td>

            <td>addColumnDate</td>

            <td>naformátuje výstup na datum</td>

            <td>formát lze měnit pomocí setDateFormat(). Existující formáty:<br>
                Date::FORMAT_DATE, Date::FORMAT_DA­TETIME, Date::FORMAT_TEXT
            </td>
        </tr>
        </tbody>
    </table>

    <h4 id="sloupce-settery">Settery</h4>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>

            <th>Příklad parametru</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>setSortable</td>

            <td>povolí řazení sloupce</td>

            <td> </td>
        </tr>

        <tr>
            <td>setReplacement</td>

            <td>nastaví masku pro nahrazování</td>

            <td>array('published' ⇒ 'ok')</td>
        </tr>

        <tr>
            <td>setColumn</td>

            <td>namapuje na sloupec v db, lze použít callback</td>

            <td>function($item)<br>{return $item->country->title}</td>
        </tr>

        <tr>
            <td>setFilter</td>

            <td>zkratka pro vytvoření filtru stejného názvu</td>

            <td> </td>
        </tr>

        <tr>
            <td>setDefaultSort</td>

            <td>výchozí řazení</td>

            <td>'ASC'</td>
        </tr>

        <tr>
            <td>setCustomRender</td>

            <td>callback pro vlastní vykreslení</td>

            <td>function($item)<br>{return $item->mail}</td>
        </tr>

        <tr>
            <td>setTruncate</td>

            <td>ořízne výstup, parametry jako pro <a href="http://api.nette.org/2.0/Nette.Utils.Strings.html#_truncate">Strings::trun­cate()</a></td>

            <td> </td>
        </tr>
        </tbody>
    </table>

    <h4 id="sloupce-gettery">Gettery</h4>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>getCellPrototype</td>

            <td>umožní nastavit např. vlastní css třídu buňce</td>
        </tr>
        <tr>
            <td>getHeaderPrototype</td>

            <td>umožní nastavit např. vlastní css třídu hlavičky sloupce</td>
        </tr>
        </tbody>
    </table>

    <hr>

    <h3 id="filtry">Filtry</h3>

    <pre><code>$grid->addFilter('bir­thday', 'Birthday', Column::TYPE_DA­TE);</code></pre>

    <p>První parametr reprezentuje název sloupce v datasource, následuje popisek
        a typ filtru. Typ je název třídy, který se má použít (lze uvést vlastní
        typ filtru).</p>

    <h4 id="filtry-typy">Typy</h4>

    <table>
        <thead>
        <tr>
            <th>Typ</th>

            <th>Metoda</th>

            <th style="width: 140px">Popis</th>

            <th>Info</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>TYPE_TEXT</td>

            <td>addFilterText</td>

            <td>výchozí typ</td>

            <td>metoda <a href="http://o5.github.com/grido-sandbox/api/class-Grido.Components.Filters.Text.html#_setSuggestion">setSuggestion()</a> povolí našeptávání zohleďnující
                aktuální filtr, parametrem lze uvést callback pro data</td>
        </tr>

        <tr>
            <td>TYPE_DATE</td>

            <td>addFilterDate</td>

            <td>hledání dle data</td>

            <td> </td>
        </tr>

        <tr>
            <td>TYPE_CHECK</td>

            <td>addFilterCheck</td>

            <td>checkbox filtr</td>

            <td></td>
        </tr>

        <tr>
            <td>TYPE_SELECT</td>

            <td>addFilterSelect</td>

            <td>selectbox filtr</td>

            <td>položky výběru se nastavují parametrem č.4</td>
        </tr>

        <tr>
            <td>TYPE_NUMBER</td>

            <td>addFilterNumber</td>

            <td>číselný typ</td>

            <td> </td>
        </tr>
        </tbody>
    </table>

    <h4 id="filtry-settery">Settery</h4>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>

            <th style="width: 330px">Příklad parametru</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>setColumn</td>

            <td>namapuje na sloupec v db, lze filtrovat pomocí více sloupců</td>

            <td>setColumn('date', Filter::OPERA­TOR_OR)</td>
        </tr>

        <tr>
            <td>setCondition</td>

            <td>vlastní sql podmínka, příklady níže</td>

            <td> </td>
        </tr>

        <tr>
            <td>setFormatValue</td>

            <td>formátování hodnoty při sestavování sql podmínky</td>

            <td>setFormatValu­e('%value%')</td>
        </tr>

        <tr>
            <td>setDefaultValue</td>

            <td>výchozí hodnota</td>

            <td> </td>
        </tr>
        </tbody>
    </table>

<pre><code>//Filter::CON­DITION_CUSTOM
$list = array('' ⇒ '', 'publihed' ⇒ 'Published', 'deleted' ⇒ 'Deleted');
$grid->addFilter('sta­tus', 'Status', Filter::TYPE_SE­LECT, $list)
    ->setCondition(Fil­ter::CONDITION_CUS­TOM, array(
        '' ⇒ '1=1',
        'publihed' ⇒ '[status] <> "deleted"',
        'deleted' ⇒ '[status] = "deleted"'
));

//Filter::CON­DITION_CALLBACK
$grid->addFilter('type', 'Type')
    ->setCondition(Fil­ter::CONDITION_CAL­LBACK, function($value){
        return array('[status] =%s' ⇒ $value);
});

//filtrování lze vyloučit
$grid->addFilter('type', 'Type')
    ->setCondition(Fil­ter::CONDITION_NOT_AP­PLY);</code></pre>


    <h4 id="filtry-gettery">Gettery</h4>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>getWrapperPrototype</td>

            <td>umožní nastavit např. vlastní css třídu elementu</td>
        </tr>
        </tbody>
    </table>

    <hr>

    <h3 id="akce">Akce</h3>

    <pre><code>$grid->addAction('edit', 'Edit');</code></pre>

    <p>První parametr je název akce, následuje popisek a typ akce. Poslední
        parametry jsou $destination a $args které se předají metodě
        <a href="http://api.nette.org/2.0/Nette.Application.UI.PresenterComponent.html#_link">$presenter->link()</a>,
        pokud se nenastaví, jako $destination se použije první parametr.
    </p>

    <h4 id="akce-settery">Settery</h4>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>

            <th style="width: 440px">Příklad parametru</th>
        </tr>
        </thead>

        <tbody>

        <tr>
            <td>setPrimaryKey</td>

            <td>nastaví "primární" klíč, který identifikuje řádek</td>

            <td> </td>
        </tr>

        <tr>
            <td>setElementPrototype</td>

            <td>vlastní html element</td>

            <td> </td>
        </tr>

        <tr>
            <td>setCustomRender</td>

            <td>callback pro vlastní vykreslení</td>

            <td>function($item, \Nette\Utils\Html $el)<br>{return $el}</td>
        </tr>

        <tr>
            <td>setCustomHref</td>

            <td>callback pro vlastní vytvoření odkazu</td>

            <td>function($item)<br>{return '/edit/{$item->id}'}</td>
        </tr>

        <tr>
            <td>setDisable</td>

            <td>callback pro ovlivnění vykreslení, když vrátí TRUE => nevykreslí se</td>

            <td>function($item)<br>{return $item->role == 'admin'}</td>
        </tr>

        <tr>
            <td>setIcon</td>

            <td>nastaví twitter bootstrap ikonu</td>

            <td>'pencil'</td>
        </tr>

        <tr>
            <td>setConfirm</td>

            <td>nastaví javascriptový confirm, lze použít callback</td>

            <td>function($item)<br>{return "Are you sure you want to delete {$item->title}?"}</td>
        </tr>
        </tbody>
    </table>

    <h4 id="akce-gettery">Gettery</h4>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>getElementPrototype</td>

            <td>umožní nastavit např. vlastní css třídu</td>
        </tr>
        </tbody>
    </table>

    <hr>

    <h3 id="operace">Operace</h3>

    <pre><code>$grid->setOperation­s(array('dele­te' ⇒ 'Delete'), function($ope­ration, $id) { … } );</code></pre>

    <p>První parametr je pole podporovaných akcí, druhý je handler volající se po vybrání akce.</p>

    <h4 id="operace-settery">Settery</h4>

    <table>
        <thead>
        <tr>
            <th>Metoda</th>

            <th>Popis</th>

            <th>Příklad parametru</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>setConfirm</td>

            <td>nastaví javascriptový confirm pro operaci</td>

            <td>"delete", "Opravdu chcete mazat?"</td>
        </tr>

        <tr>
            <td>setPrimaryKey</td>

            <td>nastaví "primární" klíč, který identifikuje řádek</td>

            <td> </td>
        </tr>
        </tbody>
    </table>

    <hr>

    <h3 id="export">Export</h3>

    <pre><code>$grid->setExporting('u­ser_export');</code></pre>

    <p>První parametr je název exportovného souboru, pokud není nastaven použije se název gridu. Formát exportu je CSV. Export zohleďňuje aktuální filtr.
    </p>
    <hr>

    <h3 id="client-side-features">Client-side features</h3>

    <ul>
        <li>ajax s kompletním stavem v URL</li>

        <li>hromadné označování řádků s podporou shiftu</li>

        <li>invertování výběru řádků</li>

        <li>prompt pro rychlé přeskočení na stranu</li>

        <li>napovídání založené na <a href="http://twitter.github.com/bootstrap/javascript.html#typeahead">Twitter Bootstrap Typeahead</a></li>

        <li><a href="https://github.com/Aymkdn/Datepicker-for-Bootstrap">Datepicker</a> pro Twitter Bootstrap</li>

        <li>zadávání datumu založené na <a href="http://digitalbush.com/projects/masked-input-plugin/">Masked input plugin</a></li>

        <li>kontrola numerického vstupu</li>

        <li>potvrzování nastavených akcí a operací</li>

        <li>odscrolování po změně</li>

        <li>cool url parametry</li>

        <li>odeslání filtru po změně hodnoty</li>
    </ul>

    <hr>

    <img src="http://img.bugyik.cz/Grido.png" alt="Screenshot">
    </section>
    </div>

    <div id="footer_wrap" class="outer">
    <footer class="inner">
        <p class="copyright">Copyright © 2013 <a target="_blank" href="http://petr.bugyik.cz">Petr Bugyík</a></p>
    </footer>
    </div>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap-dropdown.js"></script>
    <script src="js/highlight.pack.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-39540018-1', 'github.com');
        ga('send', 'pageview');
    </script>
</body>
</html>
